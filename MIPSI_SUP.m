function [t,VAR,Output] = MIPSI_SUP(qAStart , qBStart , qCStart , qDStart , qEStart , qFStart)
%===========================================================================
% File: MIPSI_SUP.m created Dec 01 2021 by MotionGenesis 5.9.
% Portions copyright (c) 2009-2020 Motion Genesis LLC.  Rights reserved.
% MotionGenesis Basic Research/Vanilla Licensee: Daniel Jacobs. (until June 2024).
% Paid-up MotionGenesis Basic Research/Vanilla licensees are granted the right
% to distribute this code for legal academic (non-professional) purposes only,
% provided this copyright notice appears in all copies and distributions.
%===========================================================================
% The software is provided "as is", without warranty of any kind, express or    
% implied, including but not limited to the warranties of merchantability or    
% fitness for a particular purpose. In no event shall the authors, contributors,
% or copyright holders be liable for any claim, damages or other liability,     
% whether in an action of contract, tort, or otherwise, arising from, out of, or
% in connection with the software or the use or other dealings in the software. 
%===========================================================================
eventDetectedByIntegratorTerminate1OrContinue0 = [];
IxxA=0; IyyE=0; IzzB=0; IzzC=0; IzzD=0; px=0; py=0; pz=0; TA=0; TB=0; TC=0; TD=0; TE=0; TF=0; dumbDt=0; qaDt=0; qbDt=0; qcDt=0; qdDt=0;
qeDt=0; qfDt=0; qaDDt=0; qbDDt=0; qcDDt=0; qdDDt=0; qeDDt=0; qfDDt=0; CbX=0; CbY=0; CbZ=0; DcX=0; DcY=0; DcZ=0; EdX=0; EdY=0; EdZ=0;
FeX=0; FeY=0; FeZ=0; IxxB=0; IxxC=0; IxxD=0; IxxE=0; IxxF=0; IyyB=0; IyyC=0; IyyD=0; IyyF=0; IzzE=0; IzzF=0; QX=0; QY=0; QZ=0;
z = zeros( 1, 303 );

%-------------------------------+--------------------------+-------------------+-----------------
% Quantity                      | Value                    | Units             | Description
%-------------------------------|--------------------------|-------------------|-----------------
g                               =  3.721;                  % m/s^2               Constant
hA                              =  3;                      % ft                  Constant
LA                              =  0.5;                    % ft                  Constant
LB                              =  2;                      % ft                  Constant
LC                              =  2;                      % ft                  Constant
LD                              =  1;                      % ft                  Constant
LE                              =  .5;                     % ft                  Constant
LF                              =  1;                      % ft                  Constant
mA                              =  25;                     % kg                  Constant
mB                              =  25;                     % kg                  Constant
mC                              =  10;                     % kg                  Constant
mD                              =  5;                      % kg                  Constant
mE                              =  5;                      % kg                  Constant
mF                              =  5;                      % kg                  Constant
qr                              =  45;                     % deg                 Constant
r                               =  .05;                    % m                   Constant
v                               =  .3;                     % m/s                 Constant

dumb                            =  0;                      % UNITS               Initial Value
qa                              =  qAStart;                     % deg                 Initial Value
qb                              =  qBStart;                    % deg                 Initial Value
qc                              =  qCStart;                    % deg                 Initial Value
qd                              =  qDStart;                      % deg                 Initial Value
qe                              =  qEStart;                      % deg                 Initial Value
qf                              =  qFStart;                     % deg                 Initial Value

tInitial                        =  15;                     % s                   Initial Time
tFinal                          =  20;                     % s                   Final Time
tStep                           =  .02;                    % s                   Integration Step
printIntScreen                  =  1;                      % 0 or +integer       0 is NO screen output
printIntFile                    =  1;                      % 0 or +integer       0 is NO file   output
absError                        =  1.0E-05;                %                     Absolute Error
relError                        =  1.0E-08;                %                     Relative Error
%-------------------------------+--------------------------+-------------------+-----------------

% Unit conversions.  UnitSystem: kg, meter, second.
DEGtoRAD = pi / 180.0;
RADtoDEG = 180.0 / pi;
hA = hA * 0.3048;                                          %  Converted from ft 
LA = LA * 0.3048;                                          %  Converted from ft 
LB = LB * 0.3048;                                          %  Converted from ft 
LC = LC * 0.3048;                                          %  Converted from ft 
LD = LD * 0.3048;                                          %  Converted from ft 
LE = LE * 0.3048;                                          %  Converted from ft 
LF = LF * 0.3048;                                          %  Converted from ft 
qr = qr * DEGtoRAD;                                        %  Converted from deg 
qa = qa * DEGtoRAD;                                        %  Converted from deg 
qb = qb * DEGtoRAD;                                        %  Converted from deg 
qc = qc * DEGtoRAD;                                        %  Converted from deg 
qd = qd * DEGtoRAD;                                        %  Converted from deg 
qe = qe * DEGtoRAD;                                        %  Converted from deg 
qf = qf * DEGtoRAD;                                        %  Converted from deg 

% Evaluate constants
IxxA = 0.5*mA*r^2;
IzzB = 0.08333333333333333*mB*(LB^2+3*r^2);
IzzC = 0.08333333333333333*mC*(LC^2+3*r^2);
IzzD = 0.08333333333333333*mD*(LD^2+3*r^2);
IyyE = 0.5*mE*r^2;
px = LA + LB + LC + LD + 0.7071067811865475*LF;
py = hA - 0.8660254037844386*LE - 0.6123724356957945*LF;
pz = -0.5*LE - 0.3535533905932737*LF;
qaDt = 0;
qaDDt = 0;
z(1) = sin(qr);
qeDt = 0;
qeDDt = 0;
qfDt = 0;
qfDDt = 0;
z(278) = mC*g;
z(277) = mB*g;
z(283) = LB*z(277);
z(285) = LC*z(278);
z(279) = mD*g;
z(287) = LD*z(279);
z(281) = mF*g;
z(290) = LF*z(281);
IxxB = 0.5*mB*r^2;
IyyB = 0.08333333333333333*mB*(LB^2+3*r^2);
IxxC = 0.5*mC*r^2;
IyyC = 0.08333333333333333*mC*(LC^2+3*r^2);
IxxD = 0.5*mD*r^2;
IyyD = 0.08333333333333333*mD*(LD^2+3*r^2);
IxxE = 0.08333333333333333*mE*(LE^2+3*r^2);
IzzE = 0.08333333333333333*mE*(LE^2+3*r^2);
IxxF = 0.5*mF*r^2;
IyyF = 0.08333333333333333*mF*(LF^2+3*r^2);
IzzF = 0.08333333333333333*mF*(LF^2+3*r^2);
z(3) = cos(qr);
z(29) = LD*z(1);
z(31) = LD*z(3);
dumbDt = 0.1234;
z(220) = mD*LD;
z(225) = mF*LF;
z(228) = IzzB + IzzC + 0.25*mB*LB^2;
z(229) = LC^2 + 4*LB^2;
z(230) = LB*LC;
z(231) = 4*LB^2 + 4*LC^2 + 4*LD^2;
z(232) = LC*LD;
z(233) = LB*LD;
z(234) = LB^2;
z(235) = LC^2;
z(236) = LD^2;
z(238) = mC*LC;
z(239) = 4*LC^2 + 4*LD^2;
z(241) = LB*LE;
z(242) = LC*LE;
z(248) = IzzC + 0.25*mC*LC^2;
z(249) = LD^2 + 4*LC^2;
z(256) = IzzD + 0.25*mD*LD^2 + 0.25*mE*(LE^2+4*LD^2);
z(257) = 4*LD^2 + 4*LE^2;
z(271) = 0.25*mF*LF^2 + IzzF;
z(280) = mE*g;


VAR = SetMatrixFromNamedQuantities;
[t,VAR,Output] = IntegrateForwardOrBackward( tInitial, tFinal, tStep, absError, relError, VAR, printIntScreen, printIntFile );
OutputToScreenOrFile( [], 0, 0 );   % Close output files.
if( printIntFile ~= 0 ),  PlotOutputFiles;  end


%===========================================================================
function sys = mdlDerivatives( t, VAR, uSimulink )
%===========================================================================
SetNamedQuantitiesFromMatrix( VAR );


z(2) = sin(qc-qb-qd);
z(4) = cos(qa);
z(5) = cos(qc-qb-qd);
z(6) = sin(qf);
z(7) = sin(qe);
z(8) = cos(qe);
z(9) = sin(qb);
z(10) = cos(qc);
z(11) = cos(qd);
z(12) = cos(qf);
z(13) = sin(qd);
z(14) = sin(qc);
z(15) = cos(qb);
z(16) = sin(qb-qc);
z(17) = cos(qb-qc);
z(18) = sin(qa);
z(20) = -(LD*(z(1)*z(2)-z(3)*z(4)*z(5))+LF*z(6)*z(7)^2*(z(1)*z(5)+z(3)*z(2)*z(4))-LE*(z(1)*z(5)+z(3)*z(2)*z(4))-LF*z(8)*(z(1)*(z(  ...
9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11))))+z(3)*z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LC*(z(3)*z(16)-z(1)*z(  ...
4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))  ...
- (LE*(z(3)*z(5)-z(1)*z(2)*z(4))-LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LF*z(6)*z(7)^2*(z(3)*z(5)-z(1)*z(2)*z(4))-LF*z(8)*(z(1)*z(4)*(  ...
z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*z(4)*  ...
z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))-  ...
LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(33) = LF*(z(4)*z(8)+z(2)*z(7)*z(18))*(z(12)*qeDt-(z(2)*z(12)+z(5)*z(6)*z(8))*qaDt) - LD*z(2)*z(4)*qaDt - z(4)*(LB*z(9)-LC*  ...
z(16)-LE*z(5))*qaDt - LF*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(  ...
9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*(qfDt+z(5)*z(7)*qaDt);
z(22) = (LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(  ...
z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(1)*z(2)-z(3)*z(4)*z(5))+LF*z(6)*z(7)^2*(z(1)*z(5)+z(3)*z(2)*z(4))-LE*(  ...
z(1)*z(5)+z(3)*z(2)*z(4))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(3)*z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))  ...
- z(18)*(LF*z(2)*z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*(LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*  ...
z(16)+z(3)*z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*  ...
z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(30) = v + LF*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))*(z(12)*qeDt-(z(2)*z(12)+z(5)*z(6)*z(8))*qaDt) - z(29)*z(2)*  ...
z(18)*qaDt - z(1)*z(18)*(LB*z(9)-LC*z(16)-LE*z(5))*qaDt - LF*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-  ...
z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(  ...
z(15)*(z(10)*(z(11)*z(21)z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11))))))*(qfDt+z(5)*z(7)*qaDt);
z(25) = -(LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(  ...
z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LE*(z(3)*z(5)-z(1)*z(2)*z(4))-LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LF*z(6)*z(7)^2*(  ...
z(3)*z(5)-z(1)*z(2)*z(4))-LF*z(8)*(z(1)*z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))) - z(18)*(LF*z(2)*  ...
z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*(LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LC*(z(3)*z(16)-z(1)*z(4)*  ...
z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))-  ...
LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(32) = z(31)*z(2)*z(18)*qaDt + z(3)*z(18)*(LB*z(9)-LC*z(16)-LE*z(5))*qaDt + LF*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))*(  ...
z(12)*qeDt-(z(2)*z(12)+z(5)*z(6)*z(8))*qaDt) - LF*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11))))))*(qfDt+z(5)*z(7)*qaDt);
z(19) = (LD*(z(1)*z(2)-z(3)*z(4)*z(5))+LF*z(6)*z(7)^2*(z(1)*z(5)+z(3)*z(2)*z(4))-LE*(z(1)*z(5)+z(3)*z(2)*z(4))-LF*z(8)*(z(1)*(z(9)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11))))+z(3)*z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(3)*z(2)+z(1)*z(4)*z(5))+LB*(z(3)*z(9)-z(1)*z(4)*  ...
z(15))-LC*(z(3)*z(16)-z(1)*z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+  ...
z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-  ...
z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))))))) + (LE*(z(3)*z(5)-z(1)*z(2)*z(4))-LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LF*z(6)*z(7)^2*(z(3)*z(5)-z(1)*z(2)*z(4))-LF*z(8)*(z(1)*  ...
z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LB*(z(1)*z(9)+z(3)*z(4)*z(15))+LD*(z(1)*z(2)-z(3)*z(  ...
4)*z(5))-LC*(z(1)*z(16)+z(3)*z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(  ...
7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-  ...
z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))))));
z(21) = z(19)*(LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*  ...
z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))) + z(20)*(LB*z(15)*z(18)+LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*  ...
z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+  ...
z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))))) + z(18)*(LF*z(2)*z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(  ...
6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*((LD*(z(3)*z(2)+z(1)*z(4)*z(5))-  ...
LC*(z(3)*z(16)-z(1)*z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(  ...
z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))*(  ...
LB*(z(1)*z(9)+z(3)*z(4)*z(15))+LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*  ...
z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(  ...
8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))-(LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*z(  ...
4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))*(LD*(z(3)*  ...
z(2)+z(1)*z(4)*z(5))+LB*(z(3)*z(9)-z(1)*z(4)*z(15))-LC*(z(3)*z(16)-z(1)*z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*  ...
z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(  ...
z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))));
z(34) = (z(20)*z(33)+z(22)*z(30)-z(25)*z(32))/z(21);
qbDt = z(34);
z(23) = z(18)*(LF*z(2)*z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(  ...
8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*(LB*(z(1)*z(9)+z(3)*z(4)*z(15))+LD*(z(  ...
1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(  ...
z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*  ...
z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11))))))) - (LB*z(15)*z(18)+LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(  ...
z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(1)*z(2)-z(3)*z(4)*z(5))+LF*z(6)*z(7)^2*(  ...
z(1)*z(5)+z(3)*z(2)*z(4))-LE*(z(1)*z(5)+z(3)*z(2)*z(4))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(3)*z(4)*(z(15)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(  ...
6)*z(8)*z(11))))));
z(26) = (LB*z(15)*z(18)+LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*  ...
z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LE*(z(3)*z(5)-z(1)*z(2)*z(4))-LD*(z(3)*z(2)+z(1)*z(4)*  ...
z(5))-LF*z(6)*z(7)^2*(z(3)*z(5)-z(1)*z(2)*z(4))-LF*z(8)*(z(1)*z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(9)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(  ...
8)*z(11)))))) + z(18)*(LF*z(2)*z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*(LD*(z(3)*z(2)+z(1)*z(4)*  ...
z(5))+LB*(z(3)*z(9)-z(1)*z(4)*z(15))-LC*(z(3)*z(16)-z(1)*z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(  ...
7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*  ...
z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(35) = (z(19)*z(33)+z(23)*z(30)-z(26)*z(32))/z(21);
qcDt = -z(35);
z(27) = (LB*z(15)*z(18)+LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*  ...
z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LC*(z(3)*z(16)-z(1)*z(  ...
4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))  ...
- (LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(z(4)*z(  ...
6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(3)*z(2)+z(1)*z(4)*z(5))+LB*(z(3)*z(9)-z(1)*z(4)*z(15))-LC*(z(3)*z(16)-z(1)*  ...
z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(24) = (LB*z(15)*z(18)+LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*  ...
z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*z(  ...
4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))  ...
- (LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(z(4)*z(  ...
6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*(LB*(z(1)*z(9)+z(3)*z(4)*z(15))+LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*  ...
z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(28) = (LD*(z(3)*z(2)+z(1)*z(4)*z(5))-LC*(z(3)*z(16)-z(1)*z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-  ...
z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*  ...
z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(  ...
8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))*(LB*(z(1)*z(9)+z(3)*z(4)*z(15))+LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(  ...
3)*z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*  ...
z(4)*z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))  ...
- (LD*(z(1)*z(2)-z(3)*z(4)*z(5))-LC*(z(1)*z(16)+z(3)*z(4)*z(17))-LE*z(8)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(  ...
LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))-LF*z(8)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*  ...
z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))))*(LD*(z(3)*z(2)+z(1)*z(4)*z(5))+LB*(z(3)*z(9)-z(1)*z(4)*z(15))-LC*(z(3)*z(16)-z(1)*  ...
z(4)*z(17))-LE*z(8)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))-z(7)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*  ...
z(7)))-LF*z(8)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))));
z(36) = (z(27)*z(32)-z(24)*z(30)-z(28)*z(33))/z(21);
qdDt = -z(36);

sys = transpose( SetMatrixOfDerivativesPriorToIntegrationStep );
end



%===========================================================================
function VAR = SetMatrixFromNamedQuantities
%===========================================================================
VAR = zeros( 1, 7 );
VAR(1) = dumb;
VAR(2) = qa;
VAR(3) = qb;
VAR(4) = qc;
VAR(5) = qd;
VAR(6) = qe;
VAR(7) = qf;
end


%===========================================================================
function SetNamedQuantitiesFromMatrix( VAR )
%===========================================================================
dumb = VAR(1);
qa = VAR(2);
qb = VAR(3);
qc = VAR(4);
qd = VAR(5);
qe = VAR(6);
qf = VAR(7);
end


%===========================================================================
function VARp = SetMatrixOfDerivativesPriorToIntegrationStep
%===========================================================================
VARp = zeros( 1, 7 );
VARp(1) = dumbDt;
VARp(2) = qaDt;
VARp(3) = qbDt;
VARp(4) = qcDt;
VARp(5) = qdDt;
VARp(6) = qeDt;
VARp(7) = qfDt;
end



%===========================================================================
function Output = mdlOutputs( t, VAR, uSimulink )
%===========================================================================
z(52) = LD*z(2)*z(18)*qaDt^2 + z(18)*(LB*z(9)-LC*z(16)-LE*z(5))*qaDt^2 + z(4)*qaDt*(LC*z(17)*(qbDt-qcDt)-LB*z(15)*qbDt-LE*z(2)*(qcDt-  ...
qbDt-qdDt)) + LF*(qfDt+z(5)*z(7)*qaDt)*(z(6)*z(7)*z(18)*qaDt-z(4)*z(6)*z(8)*qeDt-z(4)*z(7)*z(12)*qfDt-z(4)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))))*qaDt-z(18)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*  ...
z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-  ...
z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*  ...
z(11)*z(12)*qfDt)))) - LD*z(4)*z(5)*qaDt*(qcDt-qbDt-qdDt) - LF*(z(12)*qeDt-(z(2)*z(12)+z(5)*z(6)*z(8))*qaDt)*(z(4)*z(7)*qeDt+z(8)*  ...
z(18)*qaDt-z(2)*z(4)*z(7)*qaDt-z(2)*z(8)*z(18)*qeDt-z(5)*z(7)*z(18)*(qcDt-qbDt-qdDt)) - LF*(z(4)*z(8)+z(2)*z(7)*z(18))*(z(6)*qeDt*  ...
qfDt+qaDt*(z(5)*z(8)*z(12)*qfDt+z(5)*z(12)*(qcDt-qbDt-qdDt)-z(2)*z(6)*qfDt-z(5)*z(6)*z(7)*qeDt-z(2)*z(6)*z(8)*(qcDt-qbDt-qdDt)))  ...
- LF*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*qaDt*(z(5)*z(8)*qeDt-z(2)*z(7)*(qcDt-qbDt-qdDt));
z(53) = qbDt*(LB*z(4)*z(15)*qaDt+LC*z(16)*z(18)*qbDt+LF*z(2)*z(12)*z(18)*z(7)^2*qfDt+LF*z(7)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(  ...
z(11)*z(12)+2*z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-2*z(6)*z(8)*z(11)))-z(9)*(z(10)*(z(12)*z(13)-2*z(6)*z(8)*z(11))-z(14)*(z(11)*  ...
z(12)+2*z(6)*z(8)*z(13)))))*qeDt-LB*z(9)*z(18)*qbDt-LC*z(4)*z(17)*qaDt-LD*z(2)*z(18)*qbDt-LD*z(4)*z(5)*qaDt-LE*z(4)*z(7)^2*qeDt-LE*  ...
z(8)*(z(7)*z(18)*qaDt+z(2)*z(4)*z(8)*qaDt-2*z(2)*z(7)*z(18)*qeDt-z(5)*z(8)*z(18)*(qbDt+qdDt))-z(7)*(LE-LF*z(6))*(z(2)*z(4)*z(7)*qaDt+  ...
2*z(2)*z(8)*z(18)*qeDt-z(4)*z(7)*qeDt-z(8)*z(18)*qaDt-z(5)*z(7)*z(18)*(qbDt+qdDt))-LF*z(8)*(z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*  ...
z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*  ...
qaDt-z(6)*z(7)*z(18)*qaDt-z(18)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(15)*(  ...
z(14)*(z(6)*z(13)+z(8)*z(11)*z(12))+z(10)*(z(6)*z(11)-z(8)*z(12)*z(13)))*qfDt-z(9)*(z(10)*(z(6)*z(13)+z(8)*z(11)*z(12))-z(14)*(z(  ...
6)*z(11)-z(8)*z(12)*z(13)))*qfDt-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt)))  ...
+ qdDt*(z(4)*(LF*z(2)*z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*qaDt-z(18)*(LE*z(5)*(qcDt-qbDt-qdDt)-LD*  ...
z(2)*(2*qcDt-2*qbDt-qdDt)-LF*z(7)*(z(2)*z(7)*z(12)*qfDt+2*z(2)*z(6)*z(8)*qeDt+z(5)*z(6)*z(7)*(qcDt-qbDt-qdDt)+(z(15)*(z(10)*  ...
z(11)*z(12)+z(14)*(z(12)*z(13)-2*z(6)*z(8)*z(11)))-z(9)*(z(10)*z(12)*z(13)-z(14)*(z(11)*z(12)+2*z(6)*z(8)*z(13))))*qeDt)-LF*z(8)*(  ...
2*z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-2*z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(2*z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt+z(14)*(z(11)*z(12)*qdDt+z(6)*z(  ...
8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-2*z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt-z(10)*(z(6)*z(11)*qfDt+z(12)*  ...
z(13)*qdDt+2*z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt))-z(9)*(2*z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+2*  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-  ...
z(10)*(z(11)*z(12)*qdDt+z(6)*z(8)*z(13)*qdDt+2*z(6)*z(7)*z(11)*qeDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))))) + qcDt*(LC*z(4)*  ...
z(17)*qaDt+LD*z(4)*z(5)*qaDt+LE*z(4)*z(7)^2*qeDt+LD*z(2)*z(18)*(2*qbDt-qcDt)-LF*z(2)*z(12)*z(18)*z(7)^2*qfDt-LC*z(16)*z(18)*(2*qbDt-  ...
qcDt)-LE*z(8)*(2*z(2)*z(7)*z(18)*qeDt-z(7)*z(18)*qaDt-z(2)*z(4)*z(8)*qaDt-z(5)*z(8)*z(18)*(qcDt-2*qbDt-qdDt))-z(7)*(LE-LF*z(6))*(  ...
z(4)*z(7)*qeDt+z(8)*z(18)*qaDt-2*z(2)*z(8)*z(18)*qeDt-z(2)*z(4)*z(7)*qaDt-z(5)*z(7)*z(18)*(qcDt-2*qbDt-qdDt))-LF*z(7)*(z(4)*z(6)*  ...
z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+2*z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-2*z(6)*z(8)*z(11)))-z(9)*(z(10)*(z(12)*z(13)-2*z(6)*z(  ...
8)*z(11))-z(14)*(z(11)*z(12)+2*z(6)*z(8)*z(13)))))*qeDt-LF*z(8)*(z(6)*z(7)*z(18)*qaDt-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*qaDt-  ...
z(18)*(2*z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-2*z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(6)*z(13)+z(8)*z(11)*z(12))*qfDt+z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))*qcDt+z(10)*(z(6)*z(11)-z(8)*z(12)*z(13))*qfDt-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt)-z(9)*(z(14)*(z(6)*z(11)-z(8)*  ...
z(12)*z(13))*qfDt-z(10)*(z(6)*z(13)+z(8)*z(11)*z(12))*qfDt-z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt-z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))*qcDt))));
z(54) = z(52) - z(53);
z(40) = z(1)*z(18)*qaDt*(LC*z(17)*(qbDt-qcDt)-LB*z(15)*qbDt-LE*z(2)*(qcDt-qbDt-qdDt)) - z(29)*z(2)*z(4)*qaDt^2 - z(29)*z(5)*  ...
z(18)*qaDt*(qcDt-qbDt-qdDt) - z(1)*z(4)*(LB*z(9)-LC*z(16)-LE*z(5))*qaDt^2 - LF*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))*(  ...
z(6)*qeDt*qfDt+qaDt*(z(5)*z(8)*z(12)*qfDt+z(5)*z(12)*(qcDt-qbDt-qdDt)-z(2)*z(6)*qfDt-z(5)*z(6)*z(7)*qeDt-z(2)*z(6)*z(8)*(qcDt-qbDt-  ...
qdDt))) - LF*(z(12)*qeDt-(z(2)*z(12)+z(5)*z(6)*z(8))*qaDt)*(z(3)*z(2)*z(7)*(qcDt-qbDt-qdDt)-z(3)*z(5)*z(8)*qeDt-z(1)*(z(4)*z(8)*qaDt+  ...
z(2)*z(7)*z(18)*qaDt-z(7)*z(18)*qeDt-z(2)*z(4)*z(8)*qeDt-z(4)*z(5)*z(7)*(qcDt-qbDt-qdDt))) - LF*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*qaDt*(z(5)*z(8)*qeDt-z(2)*z(7)*(qcDt-qbDt-qdDt)) - LF*(qfDt+  ...
z(5)*z(7)*qaDt)*(z(3)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*  ...
z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*  ...
qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*  ...
z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-  ...
z(8)*z(12)*z(13)*qfDt)))+z(1)*(z(4)*z(6)*z(7)*qaDt+z(6)*z(8)*z(18)*qeDt+z(7)*z(12)*z(18)*qfDt+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*  ...
qaDt-z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*  ...
z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*  ...
z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(  ...
8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*  ...
z(12)*qfDt)))));
z(41) = qdDt*(LD*(z(3)*z(5)*(qcDt-qbDt-qdDt)-z(1)*z(5)*z(18)*qaDt-z(1)*z(2)*z(4)*(qcDt-qbDt-qdDt))+LF*z(7)*(z(7)*z(12)*(z(3)*z(5)-  ...
z(1)*z(2)*z(4))*qfDt+2*z(6)*z(8)*(z(3)*z(5)-z(1)*z(2)*z(4))*qeDt+z(6)*z(7)*(z(1)*z(2)*z(18)*qaDt-z(3)*z(2)*(qcDt-qbDt-qdDt)-z(1)*  ...
z(4)*z(5)*(qcDt-qbDt-qdDt))-(z(1)*z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*qeDt)-LE*(z(1)*z(  ...
2)*z(18)*qaDt-z(3)*z(2)*(qcDt-qbDt-qdDt)-z(1)*z(4)*z(5)*(qcDt-qbDt-qdDt))-LF*z(8)*(z(1)*z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*qaDt+  ...
z(3)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*  ...
z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(  ...
z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(z(10)*(z(11)*z(12)+z(6)*  ...
z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*  ...
z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*  ...
z(13)*qfDt)))-z(1)*z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*  ...
z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-  ...
z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*  ...
z(11)*z(12)*qfDt))))) + qbDt*(LB*(z(3)*z(15)*qbDt+z(1)*z(4)*z(9)*qbDt+z(1)*z(15)*z(18)*qaDt)+LE*z(7)*(z(3)*z(5)*z(8)-z(1)*(z(7)*  ...
z(18)+z(2)*z(4)*z(8)))*qeDt+LF*z(7)*z(12)*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))*qfDt+LD*(z(3)*z(5)*(qcDt-qbDt-qdDt)-z(  ...
1)*z(5)*z(18)*qaDt-z(1)*z(2)*z(4)*(qcDt-qbDt-qdDt))+LE*z(8)*(z(3)*z(5)*z(7)*qeDt+z(3)*z(2)*z(8)*(qcDt-qbDt-qdDt)-z(1)*(z(2)*z(4)*  ...
z(7)*qeDt+z(2)*z(8)*z(18)*qaDt-z(4)*z(7)*qaDt-z(8)*z(18)*qeDt-z(4)*z(5)*z(8)*(qcDt-qbDt-qdDt)))+z(7)*(LE-LF*z(6))*(z(3)*z(2)*z(7)*(  ...
qcDt-qbDt-qdDt)-z(3)*z(5)*z(8)*qeDt-z(1)*(z(4)*z(8)*qaDt+z(2)*z(7)*z(18)*qaDt-z(7)*z(18)*qeDt-z(2)*z(4)*z(8)*qeDt-z(4)*z(5)*z(7)*(  ...
qcDt-qbDt-qdDt)))+LF*z(7)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*qeDt-  ...
LC*(z(1)*z(17)*z(18)*qaDt+z(3)*z(17)*(qbDt-qcDt)+z(1)*z(4)*z(16)*(qbDt-qcDt))-z(8)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-  ...
z(2)*z(4)*z(7)))*qeDt-LF*z(8)*(z(3)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+  ...
z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*  ...
z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(  ...
6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*  ...
z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)))+z(1)*(z(4)*z(6)*z(7)*qaDt+z(6)*z(8)*z(18)*qeDt+z(7)*z(12)*z(18)*qfDt+z(18)*(z(15)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(  ...
6)*z(8)*z(11))))*qaDt-z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*  ...
z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-  ...
z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*  ...
z(11)*z(12)*qfDt)))))) - qcDt*(LE*z(7)*(z(3)*z(5)*z(8)-z(1)*(z(7)*z(18)+z(2)*z(4)*z(8)))*qeDt+LF*z(7)*z(12)*(z(3)*z(5)*z(7)+z(1)*(  ...
z(8)*z(18)-z(2)*z(4)*z(7)))*qfDt+LD*(z(3)*z(5)*(qcDt-qbDt-qdDt)-z(1)*z(5)*z(18)*qaDt-z(1)*z(2)*z(4)*(qcDt-qbDt-qdDt))+LE*z(8)*(z(  ...
3)*z(5)*z(7)*qeDt+z(3)*z(2)*z(8)*(qcDt-qbDt-qdDt)-z(1)*(z(2)*z(4)*z(7)*qeDt+z(2)*z(8)*z(18)*qaDt-z(4)*z(7)*qaDt-z(8)*z(18)*qeDt-z(  ...
4)*z(5)*z(8)*(qcDt-qbDt-qdDt)))+z(7)*(LE-LF*z(6))*(z(3)*z(2)*z(7)*(qcDt-qbDt-qdDt)-z(3)*z(5)*z(8)*qeDt-z(1)*(z(4)*z(8)*qaDt+z(2)*  ...
z(7)*z(18)*qaDt-z(7)*z(18)*qeDt-z(2)*z(4)*z(8)*qeDt-z(4)*z(5)*z(7)*(qcDt-qbDt-qdDt)))+LF*z(7)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*  ...
z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+  ...
z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*qeDt-LC*(z(1)*z(17)*z(18)*qaDt+z(3)*z(17)*(qbDt-qcDt)+z(1)*z(4)*  ...
z(16)*(qbDt-qcDt))-z(8)*(LE-LF*z(6))*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)))*qeDt-LF*z(8)*(z(3)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*  ...
z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*  ...
z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*  ...
z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(  ...
8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(  ...
6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)))+z(1)*(z(4)*z(6)*z(7)*qaDt+z(6)*  ...
z(8)*z(18)*qeDt+z(7)*z(12)*z(18)*qfDt+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*qaDt-z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-  ...
z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+  ...
z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+  ...
z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+  ...
z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+  ...
z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))))));
z(42) = z(40) - z(41);
z(46) = z(31)*z(2)*z(4)*qaDt^2 + z(31)*z(5)*z(18)*qaDt*(qcDt-qbDt-qdDt) + z(3)*z(4)*(LB*z(9)-LC*z(16)-LE*z(5))*qaDt^2 + LF*(  ...
z(12)*qeDt-(z(2)*z(12)+z(5)*z(6)*z(8))*qaDt)*(z(1)*z(5)*z(8)*qeDt-z(1)*z(2)*z(7)*(qcDt-qbDt-qdDt)-z(3)*(z(4)*z(8)*qaDt+z(2)*z(7)*  ...
z(18)*qaDt-z(7)*z(18)*qeDt-z(2)*z(4)*z(8)*qeDt-z(4)*z(5)*z(7)*(qcDt-qbDt-qdDt))) - z(3)*z(18)*qaDt*(LC*z(17)*(qbDt-qcDt)-LB*  ...
z(15)*qbDt-LE*z(2)*(qcDt-qbDt-qdDt)) - LF*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))*(z(6)*qeDt*qfDt+qaDt*(z(5)*z(8)*  ...
z(12)*qfDt+z(5)*z(12)*(qcDt-qbDt-qdDt)-z(2)*z(6)*qfDt-z(5)*z(6)*z(7)*qeDt-z(2)*z(6)*z(8)*(qcDt-qbDt-qdDt))) - LF*(z(1)*(z(9)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*qaDt*(z(5)*z(8)*qeDt-z(2)*z(7)*(qcDt-qbDt-  ...
qdDt)) - LF*(qfDt+z(5)*z(7)*qaDt)*(z(1)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+  ...
z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*  ...
z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(  ...
6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*  ...
z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)))-z(3)*(z(4)*z(6)*z(7)*qaDt+z(6)*z(8)*z(18)*qeDt+z(7)*z(12)*z(18)*qfDt+z(18)*(z(15)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(  ...
6)*z(8)*z(11))))*qaDt-z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*  ...
z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-  ...
z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*  ...
z(11)*z(12)*qfDt)))));
z(47) = qbDt*(LE*z(7)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))*qeDt+LB*(z(1)*z(15)*qbDt-z(3)*z(4)*z(9)*qbDt-z(3)*z(15)*  ...
z(18)*qaDt)+LF*z(7)*z(12)*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))*qfDt+LD*(z(3)*z(5)*z(18)*qaDt+z(1)*z(5)*(qcDt-qbDt-qdDt)+  ...
z(3)*z(2)*z(4)*(qcDt-qbDt-qdDt))+LE*z(8)*(z(1)*z(5)*z(7)*qeDt+z(1)*z(2)*z(8)*(qcDt-qbDt-qdDt)+z(3)*(z(2)*z(4)*z(7)*qeDt+z(2)*z(8)*  ...
z(18)*qaDt-z(4)*z(7)*qaDt-z(8)*z(18)*qeDt-z(4)*z(5)*z(8)*(qcDt-qbDt-qdDt)))+LF*z(7)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(  ...
z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(  ...
6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))))*qeDt-z(8)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))*qeDt-  ...
LC*(z(1)*z(17)*(qbDt-qcDt)-z(3)*z(17)*z(18)*qaDt-z(3)*z(4)*z(16)*(qbDt-qcDt))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(8)*qeDt-z(1)*z(2)*z(  ...
7)*(qcDt-qbDt-qdDt)-z(3)*(z(4)*z(8)*qaDt+z(2)*z(7)*z(18)*qaDt-z(7)*z(18)*qeDt-z(2)*z(4)*z(8)*qeDt-z(4)*z(5)*z(7)*(qcDt-qbDt-qdDt)))-  ...
LF*z(8)*(z(1)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(14)*(z(11)*z(12)+z(6)*  ...
z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+  ...
z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(  ...
z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(z(10)*(z(11)*z(12)+z(6)*  ...
z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*  ...
z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*  ...
z(13)*qfDt)))-z(3)*(z(4)*z(6)*z(7)*qaDt+z(6)*z(8)*z(18)*qeDt+z(7)*z(12)*z(18)*qfDt+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*qaDt-  ...
z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*  ...
z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*  ...
z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(  ...
8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*  ...
z(12)*qfDt)))))) - qdDt*(LF*z(7)*(z(6)*z(7)*(z(3)*z(2)*z(18)*qaDt+z(1)*z(2)*(qcDt-qbDt-qdDt)-z(3)*z(4)*z(5)*(qcDt-qbDt-qdDt))-2*z(  ...
6)*z(8)*(z(1)*z(5)+z(3)*z(2)*z(4))*qeDt-z(7)*z(12)*(z(1)*z(5)+z(3)*z(2)*z(4))*qfDt-(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*  ...
z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(3)*  ...
z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-  ...
z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))))*qeDt)-LD*(z(3)*z(5)*z(18)*qaDt+z(1)*z(5)*(qcDt-qbDt-qdDt)+z(3)*z(2)*z(4)*(qcDt-qbDt-qdDt))-  ...
LE*(z(3)*z(2)*z(18)*qaDt+z(1)*z(2)*(qcDt-qbDt-qdDt)-z(3)*z(4)*z(5)*(qcDt-qbDt-qdDt))-LF*z(8)*(z(3)*z(18)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))))*qaDt-z(1)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*  ...
z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*  ...
qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(z(10)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*  ...
z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-  ...
z(8)*z(12)*z(13)*qfDt)))-z(3)*z(4)*(z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(  ...
6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*  ...
z(11)*qdDt-z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(  ...
z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*  ...
z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*  ...
z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))))) - qcDt*(LE*z(7)*(z(1)*z(5)*z(8)+z(3)*(z(7)*z(18)+z(2)*z(4)*z(8)))*qeDt+LF*z(7)*z(12)*(z(1)*  ...
z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))*qfDt+LD*(z(3)*z(5)*z(18)*qaDt+z(1)*z(5)*(qcDt-qbDt-qdDt)+z(3)*z(2)*z(4)*(qcDt-qbDt-qdDt))+  ...
LE*z(8)*(z(1)*z(5)*z(7)*qeDt+z(1)*z(2)*z(8)*(qcDt-qbDt-qdDt)+z(3)*(z(2)*z(4)*z(7)*qeDt+z(2)*z(8)*z(18)*qaDt-z(4)*z(7)*qaDt-z(8)*  ...
z(18)*qeDt-z(4)*z(5)*z(8)*(qcDt-qbDt-qdDt)))+LF*z(7)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11))))))*qeDt-z(8)*(LE-LF*z(6))*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)))*qeDt-LC*(z(1)*z(17)*(qbDt-qcDt)-  ...
z(3)*z(17)*z(18)*qaDt-z(3)*z(4)*z(16)*(qbDt-qcDt))-z(7)*(LE-LF*z(6))*(z(1)*z(5)*z(8)*qeDt-z(1)*z(2)*z(7)*(qcDt-qbDt-qdDt)-z(3)*(z(  ...
4)*z(8)*qaDt+z(2)*z(7)*z(18)*qaDt-z(7)*z(18)*qeDt-z(2)*z(4)*z(8)*qeDt-z(4)*z(5)*z(7)*(qcDt-qbDt-qdDt)))-LF*z(8)*(z(1)*(z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(  ...
7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(  ...
7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))-z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*  ...
z(12)*qfDt)-z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)))-z(3)*(z(4)*  ...
z(6)*z(7)*qaDt+z(6)*z(8)*z(18)*qeDt+z(7)*z(12)*z(18)*qfDt+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(  ...
6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))*qaDt-z(4)*(z(15)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt+z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(14)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11))*qcDt-z(10)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt)-  ...
z(14)*(z(6)*z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt))-z(9)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))*qbDt-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))*qcDt+z(10)*(z(6)*  ...
z(11)*qfDt+z(12)*z(13)*qdDt+z(6)*z(7)*z(13)*qeDt-z(6)*z(8)*z(11)*qdDt-z(8)*z(12)*z(13)*qfDt)-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))*  ...
qcDt-z(14)*(z(11)*z(12)*qdDt+z(6)*z(7)*z(11)*qeDt+z(6)*z(8)*z(13)*qdDt-z(6)*z(13)*qfDt-z(8)*z(11)*z(12)*qfDt))))));
z(48) = z(46) - z(47);
z(55) = z(18)*z(28)*(LF*z(2)*z(6)*z(7)^2-LD*z(5)-LE*z(2)-LF*z(8)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(  ...
6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))) + z(19)*(LE*z(8)*(z(4)*z(7)-z(2)*  ...
z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(  ...
z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*  ...
z(13)-z(6)*z(8)*z(11)))))) + z(20)*(LB*z(15)*z(18)+LE*z(8)*(z(4)*z(7)-z(2)*z(8)*z(18))-LC*z(17)*z(18)-LD*z(5)*z(18)-z(7)*(LE-LF*z(  ...
6))*(z(4)*z(8)+z(2)*z(7)*z(18))-LF*z(8)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*  ...
z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))));
z(59) = (z(20)*z(54)+z(22)*z(42)-z(25)*z(48))/z(55);
z(49) = LF*z(12)*(z(4)*z(8)+z(2)*z(7)*z(18));
z(37) = LF*z(12)*(z(3)*z(5)*z(7)+z(1)*(z(8)*z(18)-z(2)*z(4)*z(7)));
z(44) = LF*z(12)*(z(1)*z(5)*z(7)-z(3)*(z(8)*z(18)-z(2)*z(4)*z(7)));
z(56) = (z(20)*z(49)+z(22)*z(37)-z(25)*z(44))/z(55);
z(50) = -LD*z(2)*z(4) - z(4)*(LB*z(9)-LC*z(16)-LE*z(5)) - LF*(z(2)*z(12)+z(5)*z(6)*z(8))*(z(4)*z(8)+z(2)*z(7)*z(18)) - LF*z(5)*z(  ...
7)*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))));
z(38) = -z(29)*z(2)*z(18) - z(1)*z(18)*(LB*z(9)-LC*z(16)-LE*z(5)) - LF*(z(2)*z(12)+z(5)*z(6)*z(8))*(z(3)*z(5)*z(7)+z(1)*(z(8)*  ...
z(18)-z(2)*z(4)*z(7))) - LF*z(5)*z(7)*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-  ...
z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))))));
z(43) = z(31)*z(2)*z(18) + z(3)*z(18)*(LB*z(9)-LC*z(16)-LE*z(5)) - LF*(z(2)*z(12)+z(5)*z(6)*z(8))*(z(1)*z(5)*z(7)-z(3)*(z(8)*  ...
z(18)-z(2)*z(4)*z(7))) - LF*z(5)*z(7)*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-  ...
z(15)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*  ...
z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*  ...
z(11))))));
z(57) = (z(20)*z(50)+z(22)*z(38)-z(25)*z(43))/z(55);
z(51) = LF*(z(4)*z(6)*z(7)+z(18)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(  ...
z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11)))));
z(39) = LF*(z(3)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(  ...
8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))+z(1)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))));
z(45) = LF*(z(1)*(z(9)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(z(12)*z(13)-z(6)*z(8)*z(11)))-z(15)*(z(14)*(z(11)*z(12)+z(6)*z(  ...
8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))-z(3)*(z(6)*z(7)*z(18)-z(4)*(z(15)*(z(10)*(z(11)*z(12)+z(6)*z(8)*z(13))+z(14)*(  ...
z(12)*z(13)-z(6)*z(8)*z(11)))+z(9)*(z(14)*(z(11)*z(12)+z(6)*z(8)*z(13))-z(10)*(z(12)*z(13)-z(6)*z(8)*z(11))))));
z(58) = (z(20)*z(51)+z(22)*z(39)-z(25)*z(45))/z(55);
qbDDt = z(59) + z(56)*qeDDt + z(57)*qaDDt - z(58)*qfDDt;
z(62) = (z(19)*z(51)+z(23)*z(39)-z(26)*z(45))/z(55);
z(63) = (z(19)*z(54)+z(23)*z(42)-z(26)*z(48))/z(55);
z(60) = (z(19)*z(49)+z(23)*z(37)-z(26)*z(44))/z(55);
z(61) = (z(19)*z(50)+z(23)*z(38)-z(26)*z(43))/z(55);
qcDDt = z(62)*qfDDt - z(63) - z(60)*qeDDt - z(61)*qaDDt;
z(66) = (z(27)*z(45)-z(24)*z(39)-z(28)*z(51))/z(55);
z(67) = (z(27)*z(48)-z(24)*z(42)-z(28)*z(54))/z(55);
z(64) = (z(27)*z(44)-z(24)*z(37)-z(28)*z(49))/z(55);
z(65) = (z(27)*z(43)-z(24)*z(38)-z(28)*z(50))/z(55);
qdDDt = z(66)*qfDDt - z(67) - z(64)*qeDDt - z(65)*qaDDt;
z(110) = LB*z(9) - 0.5*LC*z(16);
z(99) = LB*z(9);
z(135) = LD*z(2);
z(161) = LB*z(9) - LC*z(16) - 0.5*LE*z(5);
z(134) = LB*z(9) - LC*z(16);
z(202) = LB*z(9) - LC*z(16) - LE*z(5);
z(70) = z(4)*z(15);
z(68) = z(4)*z(9);
z(73) = z(14)*z(70) - z(10)*z(68);
z(76) = z(10)*z(70) + z(14)*z(68);
z(79) = z(11)*z(73) - z(13)*z(76);
z(88) = z(7)*z(79) - z(8)*z(18);
z(203) = LF*(z(2)*z(12)+z(5)*z(6)*z(8));
z(82) = z(11)*z(76) + z(13)*z(73);
z(85) = z(7)*z(18) + z(8)*z(79);
z(94) = z(12)*z(82) - z(6)*z(85);
z(204) = LF*z(5)*z(7);
z(72) = z(9)*z(14) + z(10)*z(15);
z(75) = z(9)*z(10) - z(14)*z(15);
z(78) = z(11)*z(72) - z(13)*z(75);
z(71) = z(15)*z(18);
z(69) = z(9)*z(18);
z(77) = z(10)*z(71) + z(14)*z(69);
z(74) = z(14)*z(71) - z(10)*z(69);
z(83) = z(11)*z(77) + z(13)*z(74);
z(115) = z(4)*z(83) - z(18)*z(82);
z(121) = z(115)*(qcDt-z(34));
z(105) = z(4)^2 + z(18)^2;
z(122) = z(105)*qcDt - qdDt - z(105)*z(34);
z(125) = IzzD*z(122);
z(124) = IyyD*z(121);
z(133) = z(121)*z(125) - z(122)*z(124);
z(81) = z(11)*z(75) + z(13)*z(72);
z(80) = z(11)*z(74) - z(13)*z(77);
z(114) = z(4)*z(80) - z(18)*z(79);
z(120) = z(114)*(qcDt-z(34));
z(123) = IxxD*z(120);
z(132) = z(122)*z(123) - z(120)*z(125);
z(89) = z(4)*z(8) + z(7)*z(80);
z(140) = z(4)*z(89) - z(18)*z(88);
z(146) = z(140)*qcDt - z(8)*qdDt - z(140)*z(34);
z(86) = z(8)*z(80) - z(4)*z(7);
z(139) = z(4)*z(86) - z(18)*z(85);
z(145) = z(7)*qdDt + z(139)*qcDt - z(139)*z(34);
z(147) = IxxE*z(145);
z(149) = IzzE*z(146);
z(159) = z(146)*z(147) - z(145)*z(149);
z(84) = z(8)*z(78);
z(148) = IyyE*z(121);
z(160) = z(121)*z(149) - z(146)*z(148);
z(87) = z(7)*z(78);
z(158) = z(145)*z(148) - z(121)*z(147);
z(92) = z(6)*z(83) + z(12)*z(86);
z(91) = z(6)*z(82) + z(12)*z(85);
z(173) = z(4)*z(92) - z(18)*z(91);
z(181) = z(7)*z(12);
z(183) = z(173)*qcDt + z(181)*qdDt - z(173)*z(34);
z(95) = z(12)*z(83) - z(6)*z(86);
z(174) = z(4)*z(95) - z(18)*z(94);
z(182) = z(6)*z(7);
z(184) = z(174)*qcDt - z(182)*qdDt - z(174)*z(34);
z(186) = IyyF*z(184);
z(185) = IxxF*z(183);
z(199) = z(183)*z(186) - z(184)*z(185);
z(90) = z(6)*z(81) + z(12)*z(84);
z(187) = IzzF*z(146);
z(201) = z(184)*z(187) - z(146)*z(186);
z(93) = z(12)*z(81) - z(6)*z(84);
z(200) = z(146)*z(185) - z(183)*z(187);
z(209) = 0.5*LE*(qcDt-qdDt-z(34))^2 + 0.5*LF*z(6)*z(7)^2*qdDt*(qcDt-qdDt-z(34)) + 0.5*LE*(qdDt^2+(qcDt-z(34))^2-2*qdDt*(qcDt-  ...
z(34)));
z(211) = LF*(qcDt-qdDt-z(34))*(qcDt-qdDt-z(34)-z(7)^2*(qcDt-qdDt-z(34)-z(6)^2*(qcDt-z(34))));
z(138) = z(4)*z(88) + z(18)*z(89);
z(142) = z(15)*z(87) - z(9)*z(138);
z(100) = LB*z(34)^2;
z(172) = z(4)*z(94) + z(18)*z(95);
z(176) = z(15)*z(93) - z(9)*z(172);
z(180) = z(6)*z(8);
z(136) = LD*(qcDt-qdDt-z(34))^2;
z(210) = LF*z(7)*z(8)*z(12)*(qcDt-qdDt-z(34))^2;
z(212) = LF*z(6)*z(12)*z(7)^2*(qcDt-z(34))*(qcDt-qdDt-z(34));
z(144) = z(9)*z(87) + z(15)*z(138);
z(167) = z(10)*z(142) + z(14)*z(144);
z(111) = LC*(qcDt-z(34))^2;
z(113) = z(4)*z(82) + z(18)*z(83);
z(117) = z(15)*z(81) - z(9)*z(113);
z(119) = z(9)*z(81) + z(15)*z(113);
z(166) = z(10)*z(117) + z(14)*z(119);
z(137) = z(4)*z(85) + z(18)*z(86);
z(141) = z(15)*z(84) - z(9)*z(137);
z(143) = z(9)*z(84) + z(15)*z(137);
z(165) = z(10)*z(141) + z(14)*z(143);
z(216) = z(12)*z(166) - z(6)*z(165);
z(164) = LE*(qdDt^2+(qcDt-z(34))^2-2*qdDt*(qcDt-z(34)));
z(227) = z(78)*z(133) + z(81)*z(132) + z(81)*z(159) + z(84)*z(160) + z(87)*z(158) + z(87)*z(199) + z(90)*z(201) + z(93)*z(200)  ...
+ 0.25*mF*(2*z(12)*z(204)*z(209)+2*z(135)*z(181)*z(211)+2*z(142)*z(203)*z(100)+2*z(176)*z(204)*z(100)+2*z(180)*z(204)*z(136)+4*  ...
z(115)*z(202)*z(209)-z(203)*z(210)-z(204)*z(212)-4*z(114)*z(202)*z(136)-2*z(7)*z(203)*z(136)-2*z(8)*z(135)*z(210)-2*z(135)*  ...
z(182)*z(212)-2*z(140)*z(202)*z(210)-2*z(167)*z(203)*z(111)-2*z(173)*z(202)*z(211)-2*z(174)*z(202)*z(212)-2*z(204)*z(216)*z(111))  ...
- 0.5*mD*z(114)*z(134)*z(136) - 0.5*mE*z(161)*(2*z(114)*z(136)-z(115)*z(164));
z(98) = IyyB*z(9);
z(97) = IxxB*z(15);
z(108) = IxxC*z(72);
z(109) = IyyC*z(75);
z(126) = IxxD*z(78);
z(128) = IyyD*z(81);
z(153) = IyyE*z(81);
z(150) = IxxE*z(84);
z(155) = IzzE*z(87);
z(196) = IzzF*z(87);
z(188) = IxxF*z(90);
z(192) = IyyF*z(93);
z(219) = IxxA + z(9)*z(98) + z(15)*z(97) + z(72)*z(108) + z(75)*z(109) + z(78)*z(126) + z(81)*z(128) + z(81)*z(153) + z(84)*z(150)  ...
+ z(87)*z(155) + z(87)*z(196) + z(90)*z(188) + z(93)*z(192) + mC*z(110)^2 + 0.25*mB*z(99)^2 + mE*(z(135)^2+z(161)^2+2*z(105)*  ...
z(135)*z(161)) + 0.25*mD*(z(135)^2+4*z(134)^2+4*z(105)*z(134)*z(135)) + 0.25*mF*(z(203)^2+z(204)^2+4*z(135)^2+4*z(202)^2+4*z(8)*  ...
z(135)*z(203)+4*z(135)*z(182)*z(204)+4*z(140)*z(202)*z(203)+4*z(174)*z(202)*z(204)+8*z(105)*z(135)*z(202));
z(162) = LE*z(8);
z(163) = LE*z(7);
z(178) = z(9)*z(93) + z(15)*z(172);
z(205) = z(7)*(2*LE-LF*z(6));
z(206) = LF*z(8);
z(170) = z(10)*z(144) - z(14)*z(142);
z(169) = z(10)*z(119) - z(14)*z(117);
z(168) = z(10)*z(143) - z(14)*z(141);
z(217) = z(12)*z(169) - z(6)*z(168);
z(127) = IxxD*z(114);
z(129) = IyyD*z(115);
z(154) = IyyE*z(115);
z(152) = IxxE*z(139);
z(157) = IzzE*z(140);
z(198) = IzzF*z(140);
z(191) = IxxF*z(173);
z(195) = IyyF*z(174);
z(221) = 0.5*mE*(z(7)*z(135)*z(162)-2*LD*z(115)*z(161)-z(8)*z(135)*z(163)-z(139)*z(161)*z(162)-z(140)*z(161)*z(163)) + 0.25*mF*(2*  ...
LB*z(144)*z(203)+2*LB*z(178)*z(204)+2*z(6)*z(162)*z(204)+4*z(7)*z(135)*z(162)-z(203)*z(205)-z(204)*z(206)-4*LD*z(115)*z(202)-4*  ...
z(139)*z(162)*z(202)-2*LC*z(170)*z(203)-2*LC*z(204)*z(217)-2*LD*z(12)*z(204)-2*z(8)*z(135)*z(205)-2*z(135)*z(182)*z(206)-2*  ...
z(140)*z(202)*z(205)-2*z(174)*z(202)*z(206)) - z(78)*z(127) - z(81)*z(129) - z(81)*z(154) - z(84)*z(152) - z(87)*z(157)  ...
- z(87)*z(198) - z(90)*z(191) - z(93)*z(195) - 0.5*z(220)*z(115)*z(134);
z(222) = z(78)*z(127) + z(81)*z(129) + z(81)*z(154) + z(84)*z(152) + z(87)*z(157) + z(87)*z(198) + z(90)*z(191) + z(93)*z(195)  ...
+ 0.5*z(220)*z(115)*z(134) - 0.5*mE*(z(7)*z(135)*z(162)-2*LD*z(115)*z(161)-z(8)*z(135)*z(163)-z(139)*z(161)*z(162)-z(140)*z(161)*  ...
z(163)) - 0.25*mF*(2*z(6)*z(162)*z(204)+4*z(7)*z(135)*z(162)-z(203)*z(205)-z(204)*z(206)-4*LD*z(115)*z(202)-4*z(139)*z(162)*  ...
z(202)-2*LC*z(170)*z(203)-2*LC*z(204)*z(217)-2*LD*z(12)*z(204)-2*z(8)*z(135)*z(205)-2*z(135)*z(182)*z(206)-2*z(140)*z(202)*  ...
z(205)-2*z(174)*z(202)*z(206));
z(151) = IxxE*z(7);
z(189) = IxxF*z(181);
z(207) = LF*z(6)*z(7);
z(156) = IzzE*z(8);
z(197) = IzzF*z(8);
z(194) = IyyF*z(182);
z(223) = z(84)*z(151) + z(90)*z(189) + 0.25*mF*(z(203)*z(207)+2*LE*z(180)*z(204)+2*z(8)*z(135)*z(207)+2*z(140)*z(202)*z(207)-  ...
z(204)*z(206)-4*LD*z(115)*z(202)-4*LE*z(114)*z(202)-2*LD*z(12)*z(204)-2*LE*z(7)*z(203)-2*z(135)*z(182)*z(206)-2*z(174)*z(202)*  ...
z(206)) - z(87)*z(156) - z(87)*z(197) - z(93)*z(194) - 0.5*z(220)*z(115)*z(134) - 0.5*mE*z(161)*(LE*z(114)+2*LD*z(115));
z(190) = IxxF*z(6);
z(193) = IyyF*z(12);
z(208) = LF*z(12);
z(224) = IyyE*z(81) + z(90)*z(190) + z(93)*z(193) - 0.25*mF*z(208)*(z(203)+2*z(8)*z(135)+2*z(140)*z(202));
z(226) = IzzF*z(87) + 0.25*z(225)*(z(204)+2*z(135)*z(182)+2*z(174)*z(202));
z(298) = z(278)*z(18)*z(110) + 0.5*z(277)*z(18)*z(99) + z(280)*z(18)*(z(135)+z(161)) + 0.5*z(279)*z(18)*(z(135)+2*z(134))  ...
+ 0.5*z(281)*(2*z(18)*z(135)+2*z(18)*z(202)-z(88)*z(203)-z(94)*z(204)) - z(227) - z(219)*qaDDt - z(221)*qbDDt - z(222)*qcDDt  ...
- z(223)*qdDDt - z(224)*qeDDt - z(226)*qfDDt;
TA = -z(298);
z(112) = z(4)*z(79) + z(18)*z(80);
z(118) = z(9)*z(78) + z(15)*z(112);
z(131) = z(120)*z(124) - z(121)*z(123);
z(171) = z(4)*z(91) + z(18)*z(92);
z(177) = z(9)*z(90) + z(15)*z(171);
z(214) = z(6)*z(169) + z(12)*z(168);
z(247) = 0.5*mD*(LD*z(13)*z(111)+2*LC*z(14)*z(100)-2*LB*z(14)*z(111)-LB*z(118)*z(136)-LC*z(13)*z(136)-LD*z(117)*z(100))  ...
- z(105)*z(131) - z(114)*z(133) - z(115)*z(132) - z(115)*z(159) - z(139)*z(160) - z(140)*z(158) - z(140)*z(199) - z(173)*z(201)  ...
- z(174)*z(200) - 0.5*mC*z(14)*(LB*z(111)-LC*z(100)) - 0.5*mE*(LD*z(164)+LC*z(11)*z(164)+z(141)*z(162)*z(100)+z(142)*z(163)*  ...
z(100)+2*LB*z(14)*z(111)+2*LB*z(118)*z(136)+2*LC*z(13)*z(136)+2*LD*z(117)*z(100)-2*LC*z(14)*z(100)-2*LD*z(13)*z(111)-LB*z(119)*  ...
z(164)-z(7)*z(163)*z(136)-z(8)*z(162)*z(136)-z(162)*z(165)*z(111)-z(163)*z(167)*z(111)) - 0.25*mF*(4*LD*z(209)+2*LB*z(144)*  ...
z(210)+2*LB*z(177)*z(211)+2*LB*z(178)*z(212)+2*z(6)*z(162)*z(212)+2*z(12)*z(206)*z(209)+2*z(142)*z(205)*z(100)+2*z(176)*z(206)*  ...
z(100)+2*z(180)*z(206)*z(136)+4*LB*z(14)*z(111)+4*LB*z(118)*z(136)+4*LC*z(11)*z(209)+4*LC*z(13)*z(136)+4*LD*z(117)*z(100)+4*  ...
z(141)*z(162)*z(100)-z(205)*z(210)-z(206)*z(212)-4*LB*z(119)*z(209)-4*LC*z(14)*z(100)-4*LD*z(13)*z(111)-4*z(8)*z(162)*z(136)-4*  ...
z(162)*z(165)*z(111)-2*LC*z(170)*z(210)-2*LC*z(214)*z(211)-2*LC*z(217)*z(212)-2*LD*z(6)*z(211)-2*LD*z(12)*z(212)-2*z(7)*z(205)*  ...
z(136)-2*z(12)*z(162)*z(211)-2*z(167)*z(205)*z(111)-2*z(206)*z(216)*z(111));
z(130) = IzzD*z(105);
z(237) = z(228) + z(105)*z(130) + z(114)*z(127) + z(115)*z(129) + z(115)*z(154) + z(139)*z(152) + z(140)*z(157) + z(140)*z(198)  ...
+ z(173)*z(191) + z(174)*z(195) + 0.25*mC*(z(229)-4*z(230)*z(10)) + 0.25*mD*(z(236)+4*z(234)+4*z(235)+4*z(232)*z(11)-8*z(230)*  ...
z(10)-4*z(233)*z(119)) + 0.25*mF*(z(231)+z(205)^2+z(206)^2+4*z(162)^2+8*z(232)*z(11)+4*LC*z(170)*z(205)+4*LC*z(206)*z(217)+4*LD*  ...
z(12)*z(206)+8*LC*z(162)*z(168)-8*z(230)*z(10)-8*z(233)*z(119)-8*LB*z(143)*z(162)-4*LB*z(144)*z(205)-4*LB*z(178)*z(206)-4*z(6)*  ...
z(162)*z(206)) - 0.25*mE*(8*z(230)*z(10)+8*z(233)*z(119)+4*LB*z(143)*z(162)+4*LB*z(144)*z(163)-4*z(234)-4*z(235)-4*z(236)-8*  ...
z(232)*z(11)-z(162)^2-z(163)^2-4*LC*z(162)*z(168)-4*LC*z(163)*z(170));
z(240) = 0.25*mE*(4*z(230)*z(10)+4*z(233)*z(119)+2*LB*z(143)*z(162)+2*LB*z(144)*z(163)-4*z(235)-4*z(236)-8*z(232)*z(11)-z(162)^2-z(163)^2-  ...
4*LC*z(162)*z(168)-4*LC*z(163)*z(170)) - IzzC - z(105)*z(130) - z(114)*z(127) - z(115)*z(129) - z(115)*z(154) - z(139)*z(152)  ...
- z(140)*z(157) - z(140)*z(198) - z(173)*z(191) - z(174)*z(195) - 0.25*z(238)*(LC-2*LB*z(10)) - 0.25*mD*(z(236)+4*z(235)+4*  ...
z(232)*z(11)-4*z(230)*z(10)-2*z(233)*z(119)) - 0.25*mF*(z(239)+z(205)^2+z(206)^2+4*z(162)^2+8*z(232)*z(11)+4*LC*z(170)*z(205)+4*LC*  ...
z(206)*z(217)+4*LD*z(12)*z(206)+8*LC*z(162)*z(168)-4*z(230)*z(10)-4*z(233)*z(119)-4*LB*z(143)*z(162)-4*z(6)*z(162)*z(206)-2*LB*  ...
z(144)*z(205)-2*LB*z(178)*z(206));
z(243) = IzzD*z(105) + z(140)*z(156) + z(140)*z(197) + z(174)*z(194) + 0.25*mF*(4*z(236)+z(206)^2+4*z(232)*z(11)+2*LB*z(144)*  ...
z(207)+2*LC*z(206)*z(217)+2*LE*z(7)*z(205)+4*LD*z(12)*z(206)+4*LE*z(8)*z(162)-4*z(233)*z(119)-4*z(241)*z(118)-4*z(242)*z(13)-  ...
z(205)*z(207)-2*LB*z(178)*z(206)-2*LC*z(170)*z(207)-2*LE*z(180)*z(206)-2*z(6)*z(162)*z(206)) - z(139)*z(151) - z(173)*z(189)  ...
- 0.25*z(220)*(2*LB*z(119)-LD-2*LC*z(11)) - 0.25*mE*(2*z(241)*z(118)+2*z(242)*z(13)+4*z(233)*z(119)-4*z(236)-4*z(232)*z(11)-LE*z(  ...
7)*z(163)-LE*z(8)*z(162));
z(244) = 0.5*mE*(z(7)*z(135)*z(162)-2*LD*z(115)*z(161)-z(8)*z(135)*z(163)-z(139)*z(161)*z(162)-z(140)*z(161)*z(163)) + 0.25*mF*(2*  ...
LB*z(144)*z(203)+2*LB*z(178)*z(204)+2*z(6)*z(162)*z(204)+4*z(7)*z(135)*z(162)-z(203)*z(205)-z(204)*z(206)-4*LD*z(115)*z(202)-4*  ...
z(139)*z(162)*z(202)-2*LC*z(170)*z(203)-2*LC*z(204)*z(217)-2*LD*z(12)*z(204)-2*z(8)*z(135)*z(205)-2*z(135)*z(182)*z(206)-2*  ...
z(140)*z(202)*z(205)-2*z(174)*z(202)*z(206)) - z(114)*z(126) - z(115)*z(128) - z(115)*z(153) - z(139)*z(150) - z(140)*z(155)  ...
- z(140)*z(196) - z(173)*z(188) - z(174)*z(192) - 0.5*z(220)*z(115)*z(134);
z(245) = -IyyE*z(115) - z(173)*z(190) - z(174)*z(193) - 0.25*mF*z(208)*(2*LB*z(144)-z(205)-2*LC*z(170));
z(246) = -IzzF*z(140) - 0.25*z(225)*(z(206)+2*LC*z(217)+2*LD*z(12)-2*LB*z(178)-2*z(6)*z(162));
z(299) = -0.5*z(283)*z(70) - 0.5*z(278)*(2*LB*z(70)-LC*z(76)) - 0.5*z(279)*(2*LB*z(70)-2*LC*z(76)-LD*z(82)) - 0.5*z(280)*(2*LB*  ...
z(70)-2*LC*z(76)-2*LD*z(82)-z(85)*z(162)-z(88)*z(163)) - 0.5*z(281)*(2*LB*z(70)-2*LC*z(76)-2*LD*z(82)-2*z(85)*z(162)-z(88)*  ...
z(205)-z(94)*z(206)) - z(247) - z(237)*qbDDt - z(240)*qcDDt - z(243)*qdDDt - z(244)*qaDDt - z(245)*qeDDt - z(246)*qfDDt;
TB = z(299);
z(255) = z(105)*z(131) + z(114)*z(133) + z(115)*z(132) + z(115)*z(159) + z(139)*z(160) + z(140)*z(158) + z(140)*z(199)  ...
+ z(173)*z(201) + z(174)*z(200) + 0.5*mE*(LD*z(164)+LC*z(11)*z(164)+z(141)*z(162)*z(100)+z(142)*z(163)*z(100)+2*LC*z(13)*z(136)+2*  ...
LD*z(117)*z(100)-2*LC*z(14)*z(100)-2*LD*z(13)*z(111)-z(7)*z(163)*z(136)-z(8)*z(162)*z(136)-z(162)*z(165)*z(111)-z(163)*z(167)*  ...
z(111)) + 0.25*mF*(4*LD*z(209)+2*z(6)*z(162)*z(212)+2*z(12)*z(206)*z(209)+2*z(142)*z(205)*z(100)+2*z(176)*z(206)*z(100)+2*z(180)*  ...
z(206)*z(136)+4*LC*z(11)*z(209)+4*LC*z(13)*z(136)+4*LD*z(117)*z(100)+4*z(141)*z(162)*z(100)-z(205)*z(210)-z(206)*z(212)-4*LC*  ...
z(14)*z(100)-4*LD*z(13)*z(111)-4*z(8)*z(162)*z(136)-4*z(162)*z(165)*z(111)-2*LC*z(170)*z(210)-2*LC*z(214)*z(211)-2*LC*z(217)*  ...
z(212)-2*LD*z(6)*z(211)-2*LD*z(12)*z(212)-2*z(7)*z(205)*z(136)-2*z(12)*z(162)*z(211)-2*z(167)*z(205)*z(111)-2*z(206)*z(216)*  ...
z(111)) - 0.5*z(238)*z(14)*z(100) - 0.5*mD*(LD*z(13)*z(111)+2*LC*z(14)*z(100)-LC*z(13)*z(136)-LD*z(117)*z(100));
z(250) = z(248) + z(105)*z(130) + z(114)*z(127) + z(115)*z(129) + z(115)*z(154) + z(139)*z(152) + z(140)*z(157) + z(140)*z(198)  ...
+ z(173)*z(191) + z(174)*z(195) + 0.25*mD*(z(249)+4*z(232)*z(11)) + 0.25*mE*(z(239)+z(162)^2+z(163)^2+8*z(232)*z(11)+4*LC*z(162)*  ...
z(168)+4*LC*z(163)*z(170)) + 0.25*mF*(z(239)+z(205)^2+z(206)^2+4*z(162)^2+8*z(232)*z(11)+4*LC*z(170)*z(205)+4*LC*z(206)*z(217)+4*  ...
LD*z(12)*z(206)+8*LC*z(162)*z(168)-4*z(6)*z(162)*z(206));
z(251) = z(139)*z(151) + z(173)*z(189) + 0.25*mE*(2*z(242)*z(13)-4*z(236)-4*z(232)*z(11)-LE*z(7)*z(163)-LE*z(8)*z(162))  ...
- IzzD*z(105) - z(140)*z(156) - z(140)*z(197) - z(174)*z(194) - 0.25*z(220)*(LD+2*LC*z(11)) - 0.25*mF*(4*z(236)+z(206)^2+4*  ...
z(232)*z(11)+2*LC*z(206)*z(217)+2*LE*z(7)*z(205)+4*LD*z(12)*z(206)+4*LE*z(8)*z(162)-4*z(242)*z(13)-z(205)*z(207)-2*LC*z(170)*  ...
z(207)-2*LE*z(180)*z(206)-2*z(6)*z(162)*z(206));
z(252) = z(114)*z(126) + z(115)*z(128) + z(115)*z(153) + z(139)*z(150) + z(140)*z(155) + z(140)*z(196) + z(173)*z(188)  ...
+ z(174)*z(192) + 0.5*z(220)*z(115)*z(134) - 0.5*mE*(z(7)*z(135)*z(162)-2*LD*z(115)*z(161)-z(8)*z(135)*z(163)-z(139)*z(161)*  ...
z(162)-z(140)*z(161)*z(163)) - 0.25*mF*(2*z(6)*z(162)*z(204)+4*z(7)*z(135)*z(162)-z(203)*z(205)-z(204)*z(206)-4*LD*z(115)*z(202)-  ...
4*z(139)*z(162)*z(202)-2*LC*z(170)*z(203)-2*LC*z(204)*z(217)-2*LD*z(12)*z(204)-2*z(8)*z(135)*z(205)-2*z(135)*z(182)*z(206)-2*  ...
z(140)*z(202)*z(205)-2*z(174)*z(202)*z(206));
z(253) = IyyE*z(115) + z(173)*z(190) + z(174)*z(193) - 0.25*mF*z(208)*(z(205)+2*LC*z(170));
z(254) = IzzF*z(140) + 0.25*z(225)*(z(206)+2*LC*z(217)+2*LD*z(12)-2*z(6)*z(162));
z(300) = -0.5*z(285)*z(76) - 0.5*z(279)*(LD*z(82)+2*LC*z(76)) - 0.5*z(280)*(z(85)*z(162)+z(88)*z(163)+2*LC*z(76)+2*LD*z(82))  ...
- 0.5*z(281)*(z(88)*z(205)+z(94)*z(206)+2*LC*z(76)+2*LD*z(82)+2*z(85)*z(162)) - z(255) - z(240)*qbDDt - z(250)*qcDDt - z(251)*qdDDt  ...
- z(252)*qaDDt - z(253)*qeDDt - z(254)*qfDDt;
TC = -z(300);
z(116) = z(15)*z(78) - z(9)*z(112);
z(179) = z(8)*z(12);
z(264) = z(7)*z(160) + z(181)*z(201) + 0.5*z(220)*(z(13)*z(111)-z(117)*z(100)) + 0.5*mE*(LE*z(136)+LE*z(11)*z(111)+2*LD*z(13)*  ...
z(111)-LD*z(164)-2*LD*z(117)*z(100)-LE*z(116)*z(100)) - z(131) - z(8)*z(158) - z(8)*z(199) - z(182)*z(200) - 0.25*mF*(z(207)*  ...
z(210)+4*LD*z(209)+2*LE*z(180)*z(212)+2*z(7)*z(207)*z(136)+2*z(12)*z(206)*z(209)+2*z(167)*z(207)*z(111)+2*z(176)*z(206)*z(100)+2*  ...
z(180)*z(206)*z(136)+4*LD*z(117)*z(100)+4*LE*z(116)*z(100)-4*LE*z(136)-z(206)*z(212)-4*LD*z(13)*z(111)-4*LE*z(11)*z(111)-2*LD*z(6)*  ...
z(211)-2*LD*z(12)*z(212)-2*LE*z(7)*z(210)-2*LE*z(179)*z(211)-2*z(142)*z(207)*z(100)-2*z(206)*z(216)*z(111));
z(258) = z(256) + z(7)*z(151) + z(8)*z(156) + z(8)*z(197) + z(181)*z(189) + z(182)*z(194) + 0.25*mF*(z(257)+z(206)^2+z(207)^2+4*LD*  ...
z(12)*z(206)-4*LE*z(7)*z(207)-4*LE*z(180)*z(206));
z(259) = z(130) + z(8)*z(157) + z(8)*z(198) + z(182)*z(195) + 0.25*mF*(4*z(236)+z(206)^2+4*z(232)*z(11)+2*LB*z(144)*z(207)+2*LC*  ...
z(206)*z(217)+2*LE*z(7)*z(205)+4*LD*z(12)*z(206)+4*LE*z(8)*z(162)-4*z(233)*z(119)-4*z(241)*z(118)-4*z(242)*z(13)-z(205)*z(207)-2*  ...
LB*z(178)*z(206)-2*LC*z(170)*z(207)-2*LE*z(180)*z(206)-2*z(6)*z(162)*z(206)) - z(7)*z(152) - z(181)*z(191) - 0.25*z(220)*(2*LB*  ...
z(119)-LD-2*LC*z(11)) - 0.25*mE*(2*z(241)*z(118)+2*z(242)*z(13)+4*z(233)*z(119)-4*z(236)-4*z(232)*z(11)-LE*z(7)*z(163)-LE*z(8)*  ...
z(162));
z(260) = z(7)*z(152) + z(181)*z(191) + 0.25*mE*(2*z(242)*z(13)-4*z(236)-4*z(232)*z(11)-LE*z(7)*z(163)-LE*z(8)*z(162)) - z(130)  ...
- z(8)*z(157) - z(8)*z(198) - z(182)*z(195) - 0.25*z(220)*(LD+2*LC*z(11)) - 0.25*mF*(4*z(236)+z(206)^2+4*z(232)*z(11)+2*LC*  ...
z(206)*z(217)+2*LE*z(7)*z(205)+4*LD*z(12)*z(206)+4*LE*z(8)*z(162)-4*z(242)*z(13)-z(205)*z(207)-2*LC*z(170)*z(207)-2*LE*z(180)*  ...
z(206)-2*z(6)*z(162)*z(206));
z(261) = z(7)*z(150) + z(181)*z(188) + 0.25*mF*(z(203)*z(207)+2*LE*z(180)*z(204)+2*z(8)*z(135)*z(207)+2*z(140)*z(202)*z(207)-  ...
z(204)*z(206)-4*LD*z(115)*z(202)-4*LE*z(114)*z(202)-2*LD*z(12)*z(204)-2*LE*z(7)*z(203)-2*z(135)*z(182)*z(206)-2*z(174)*z(202)*  ...
z(206)) - z(8)*z(155) - z(8)*z(196) - z(182)*z(192) - 0.5*z(220)*z(115)*z(134) - 0.5*mE*z(161)*(LE*z(114)+2*LD*z(115));
z(262) = -IzzF*z(8) - 0.25*z(225)*(z(206)+2*LD*z(12)-2*LE*z(180));
z(263) = z(181)*z(190) - z(182)*z(193) - 0.25*mF*z(208)*(z(207)-2*LE*z(7));
z(301) = 0.5*z(287)*z(82) + 0.5*z(280)*(LE*z(79)+2*LD*z(82)) - 0.5*z(281)*(z(88)*z(207)-2*LD*z(82)-2*LE*z(79)-z(94)*z(206))  ...
- z(264) - z(258)*qdDDt - z(259)*qbDDt - z(260)*qcDDt - z(261)*qaDDt - z(262)*qfDDt - z(263)*qeDDt;
TD = z(301);
z(270) = z(159) + z(6)*z(201) + z(12)*z(200) - 0.25*mF*z(208)*(2*z(142)*z(100)-z(210)-2*z(7)*z(136)-2*z(167)*z(111));
z(265) = IyyE + z(6)*z(190) + z(12)*z(193) + 0.25*mF*z(208)^2;
z(266) = z(153) + z(6)*z(188) + z(12)*z(192) - 0.25*mF*z(208)*(z(203)+2*z(8)*z(135)+2*z(140)*z(202));
z(267) = z(154) + z(6)*z(191) + z(12)*z(195) - 0.25*mF*z(208)*(z(205)+2*LC*z(170));
z(268) = -z(154) - z(6)*z(191) - z(12)*z(195) - 0.25*mF*z(208)*(2*LB*z(144)-z(205)-2*LC*z(170));
z(269) = z(6)*z(189) - z(12)*z(194) - 0.25*mF*z(208)*(z(207)-2*LE*z(7));
z(302) = 0.5*z(281)*z(88)*z(208) - z(270) - z(265)*qeDDt - z(266)*qaDDt - z(267)*qcDDt - z(268)*qbDDt - z(269)*qdDDt;
TE = -z(302);
z(276) = z(199) + 0.25*z(225)*(2*z(12)*z(209)+2*z(176)*z(100)+2*z(180)*z(136)-z(212)-2*z(216)*z(111));
z(272) = z(196) + 0.25*z(225)*(z(204)+2*z(135)*z(182)+2*z(174)*z(202));
z(273) = z(198) + 0.25*z(225)*(z(206)+2*LC*z(217)+2*LD*z(12)-2*z(6)*z(162));
z(274) = -z(197) - 0.25*z(225)*(z(206)+2*LD*z(12)-2*LE*z(180));
z(275) = -z(198) - 0.25*z(225)*(z(206)+2*LC*z(217)+2*LD*z(12)-2*LB*z(178)-2*z(6)*z(162));
z(303) = -0.5*z(290)*z(94) - z(276) - z(271)*qfDDt - z(272)*qaDDt - z(273)*qcDDt - z(274)*qdDDt - z(275)*qbDDt;
TF = -z(303);
QX = LA + LC*z(72) + LD*z(78) + LF*z(90) - LB*z(15) - LE*z(81);
QY = hA + LB*z(68) + LC*z(73) + LD*z(79) + LF*z(91) - LE*z(82);
QZ = LB*z(69) + LC*z(74) + LD*z(80) + LF*z(92) - LE*z(83);
CbX = LA - LB*z(15);
CbY = hA + LB*z(68);
CbZ = LB*z(69);
DcX = LA + LC*z(72) - LB*z(15);
DcY = hA + LB*z(68) + LC*z(73);
DcZ = LB*z(69) + LC*z(74);
EdX = LA + LC*z(72) + LD*z(78) - LB*z(15);
EdY = hA + LB*z(68) + LC*z(73) + LD*z(79);
EdZ = LB*z(69) + LC*z(74) + LD*z(80);
FeX = LA + LC*z(72) + LD*z(78) - LB*z(15) - LE*z(81);
FeY = hA + LB*z(68) + LC*z(73) + LD*z(79) - LE*z(82);
FeZ = LB*z(69) + LC*z(74) + LD*z(80) - LE*z(83);

Output = zeros( 1, 43 );
Output(1) = t;
Output(2) = 0.0;
Output(3) = hA;
Output(4) = 0.0;
Output(5) = LA;
Output(6) = hA;
Output(7) = 0.0;
Output(8) = CbX;
Output(9) = CbY;
Output(10) = CbZ;
Output(11) = DcX;
Output(12) = DcY;
Output(13) = DcZ;
Output(14) = EdX;
Output(15) = EdY;
Output(16) = EdZ;
Output(17) = FeX;
Output(18) = FeY;
Output(19) = FeZ;
Output(20) = QX;
Output(21) = QY;
Output(22) = QZ;
Output(23) = px;
Output(24) = py;
Output(25) = pz;

Output(26) = t;
Output(27) = qa*RADtoDEG;                             % Converted to deg
Output(28) = qb*RADtoDEG;                             % Converted to deg
Output(29) = qc*RADtoDEG;                             % Converted to deg
Output(30) = qd*RADtoDEG;                             % Converted to deg
Output(31) = qe*RADtoDEG;                             % Converted to deg
Output(32) = qf*RADtoDEG;                             % Converted to deg

Output(33) = t;
Output(34) = QX;
Output(35) = QY;
Output(36) = QZ;

Output(37) = t;
Output(38) = TA;
Output(39) = TB;
Output(40) = TC;
Output(41) = TD;
Output(42) = TE;
Output(43) = TF;
end


%===========================================================================
function OutputToScreenOrFile( Output, shouldPrintToScreen, shouldPrintToFile )
%===========================================================================
persistent FileIdentifier hasHeaderInformationBeenWritten;

if( isempty(Output) ),
   if( ~isempty(FileIdentifier) ),
      for( i = 1 : 4 ),  fclose( FileIdentifier(i) );  end
      clear FileIdentifier;
      fprintf( 1, '\n Output is in the files MIPSI_SUP.i  (i=1,2,3,4)\n\n' );
   end
   clear hasHeaderInformationBeenWritten;
   return;
end

if( isempty(hasHeaderInformationBeenWritten) ),
   if( shouldPrintToScreen ),
      fprintf( 1,                '%%       t             AoX            AoY            AoZ            BaX            BaY            BaZ            CbX            CbY            CbZ            DcX            DcY            DcZ            EdX            EdY            EdZ            FeX            FeY            FeZ            QX             QY             QZ            RockX          RockY          RockZ\n' );
      fprintf( 1,                '%%     (sec)           (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)\n\n' );
   end
   if( shouldPrintToFile && isempty(FileIdentifier) ),
      FileIdentifier = zeros( 1, 4 );
      FileIdentifier(1) = fopen('MIPSI_SUP.1', 'wt');   if( FileIdentifier(1) == -1 ), error('Error: unable to open file MIPSI_SUP.1'); end
      fprintf(FileIdentifier(1), '%% FILE: MIPSI_SUP.1\n%%\n' );
      fprintf(FileIdentifier(1), '%%       t             AoX            AoY            AoZ            BaX            BaY            BaZ            CbX            CbY            CbZ            DcX            DcY            DcZ            EdX            EdY            EdZ            FeX            FeY            FeZ            QX             QY             QZ            RockX          RockY          RockZ\n' );
      fprintf(FileIdentifier(1), '%%     (sec)           (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)            (m)\n\n' );
      FileIdentifier(2) = fopen('MIPSI_SUP.2', 'wt');   if( FileIdentifier(2) == -1 ), error('Error: unable to open file MIPSI_SUP.2'); end
      fprintf(FileIdentifier(2), '%% FILE: MIPSI_SUP.2\n%%\n' );
      fprintf(FileIdentifier(2), '%%       t             qa             qb             qc             qd             qe             qf\n' );
      fprintf(FileIdentifier(2), '%%     (sec)          (deg)          (deg)          (deg)          (deg)          (deg)          (deg)\n\n' );
      FileIdentifier(3) = fopen('MIPSI_SUP.3', 'wt');   if( FileIdentifier(3) == -1 ), error('Error: unable to open file MIPSI_SUP.3'); end
      fprintf(FileIdentifier(3), '%% FILE: MIPSI_SUP.3\n%%\n' );
      fprintf(FileIdentifier(3), '%%       t             QX             QY             QZ\n' );
      fprintf(FileIdentifier(3), '%%     (sec)           (m)            (m)            (m)\n\n' );
      FileIdentifier(4) = fopen('MIPSI_SUP.4', 'wt');   if( FileIdentifier(4) == -1 ), error('Error: unable to open file MIPSI_SUP.4'); end
      fprintf(FileIdentifier(4), '%% FILE: MIPSI_SUP.4\n%%\n' );
      fprintf(FileIdentifier(4), '%%       t             TA             TB             TC             TD             TE             TF\n' );
      fprintf(FileIdentifier(4), '%%     (sec)         (UNITS)        (UNITS)        (UNITS)        (UNITS)        (UNITS)        (UNITS)\n\n' );
   end
   hasHeaderInformationBeenWritten = 1;
end

if( shouldPrintToScreen ), WriteNumericalData( 1,                 Output(1:25) );  end
if( shouldPrintToFile ),   WriteNumericalData( FileIdentifier(1), Output(1:25) );  end
if( shouldPrintToFile ),   WriteNumericalData( FileIdentifier(2), Output(26:32) );  end
if( shouldPrintToFile ),   WriteNumericalData( FileIdentifier(3), Output(33:36) );  end
if( shouldPrintToFile ),   WriteNumericalData( FileIdentifier(4), Output(37:43) );  end
end


%===========================================================================
function WriteNumericalData( fileIdentifier, Output )
%===========================================================================
numberOfOutputQuantities = length( Output );
if( numberOfOutputQuantities > 0 ),
   for( i = 1 : numberOfOutputQuantities ),
      fprintf( fileIdentifier, ' %- 14.6E', Output(i) );
   end
   fprintf( fileIdentifier, '\n' );
end
end



%===========================================================================
function PlotOutputFiles
%===========================================================================

figure;
data = load( 'MIPSI_SUP.2' ); 
plot( data(:,1),data(:,2),'-b', data(:,1),data(:,3),'-.g', data(:,1),data(:,4),'--r', data(:,1),data(:,5),'-m', data(:,1),data(:,6),'-.k', data(:,1),data(:,7),'--b', 'LineWidth',3 );
legend( 'qa (deg)', 'qb (deg)', 'qc (deg)', 'qd (deg)', 'qe (deg)', 'qf (deg)' );
xlabel('t (sec)');   % ylabel('Some y-axis label');   title('Some plot title');
clear data;

figure;
data = load( 'MIPSI_SUP.3' ); 
plot( data(:,1),data(:,2),'-b', data(:,1),data(:,3),'-.g', data(:,1),data(:,4),'--r', 'LineWidth',3 );
legend( 'QX (m)', 'QY (m)', 'QZ (m)' );
xlabel('t (sec)');   % ylabel('Some y-axis label');   title('Some plot title');
clear data;

figure;
data = load( 'MIPSI_SUP.4' ); 
plot( data(:,1),data(:,2),'-b', data(:,1),data(:,3),'-.g', data(:,1),data(:,4),'--r', data(:,1),data(:,5),'-m', data(:,1),data(:,6),'-.k', data(:,1),data(:,7),'--b', 'LineWidth',3 );
legend( 'TA', 'TB', 'TC', 'TD', 'TE', 'TF' );
xlabel('t (sec)');   % ylabel('Some y-axis label');   title('Some plot title');
clear data;
end



%===========================================================================
function [functionsToEvaluateForEvent, eventTerminatesIntegration1Otherwise0ToContinue, eventDirection_AscendingIs1_CrossingIs0_DescendingIsNegative1] = EventDetection( t, VAR, uSimulink )
%===========================================================================
% Detects when designated functions are zero or cross zero with positive or negative slope.
% Step 1: Uncomment call to mdlDerivatives and mdlOutputs.
% Step 2: Change functionsToEvaluateForEvent,                      e.g., change  []  to  [t - 5.67]  to stop at t = 5.67.
% Step 3: Change eventTerminatesIntegration1Otherwise0ToContinue,  e.g., change  []  to  [1]  to stop integrating.
% Step 4: Change eventDirection_AscendingIs1_CrossingIs0_DescendingIsNegative1,  e.g., change  []  to  [1].
% Step 5: Possibly modify function EventDetectedByIntegrator (if eventTerminatesIntegration1Otherwise0ToContinue is 0).
%---------------------------------------------------------------------------
% mdlDerivatives( t, VAR, uSimulink );        % UNCOMMENT FOR EVENT HANDLING
% mdlOutputs(     t, VAR, uSimulink );        % UNCOMMENT FOR EVENT HANDLING
functionsToEvaluateForEvent = [];
eventTerminatesIntegration1Otherwise0ToContinue = [];
eventDirection_AscendingIs1_CrossingIs0_DescendingIsNegative1 = [];
eventDetectedByIntegratorTerminate1OrContinue0 = eventTerminatesIntegration1Otherwise0ToContinue;
end


%===========================================================================
function [isIntegrationFinished, VAR] = EventDetectedByIntegrator( t, VAR, nIndexOfEvents )
%===========================================================================
isIntegrationFinished = eventDetectedByIntegratorTerminate1OrContinue0( nIndexOfEvents );
if( ~isIntegrationFinished ),
   SetNamedQuantitiesFromMatrix( VAR );
%  Put code here to modify how integration continues.
   VAR = SetMatrixFromNamedQuantities;
end
end



%===========================================================================
function [t,VAR,Output] = IntegrateForwardOrBackward( tInitial, tFinal, tStep, absError, relError, VAR, printIntScreen, printIntFile )
%===========================================================================
OdeMatlabOptions = odeset( 'RelTol',relError, 'AbsTol',absError, 'MaxStep',tStep, 'Events',@EventDetection );
t = tInitial;                 epsilonT = 0.001*tStep;                   tFinalMinusEpsilonT = tFinal - epsilonT;
printCounterScreen = 0;       integrateForward = tFinal >= tInitial;    tAtEndOfIntegrationStep = t + tStep;
printCounterFile   = 0;       isIntegrationFinished = 0;
mdlDerivatives( t, VAR, 0 );
while 1,
   if( (integrateForward && t >= tFinalMinusEpsilonT) || (~integrateForward && t <= tFinalMinusEpsilonT) ), isIntegrationFinished = 1;  end
   shouldPrintToScreen = printIntScreen && ( isIntegrationFinished || printCounterScreen <= 0.01 );
   shouldPrintToFile   = printIntFile   && ( isIntegrationFinished || printCounterFile   <= 0.01 );
   if( isIntegrationFinished || shouldPrintToScreen || shouldPrintToFile ),
      Output = mdlOutputs( t, VAR, 0 );
      OutputToScreenOrFile( Output, shouldPrintToScreen, shouldPrintToFile );
      if( isIntegrationFinished ), break;  end
      if( shouldPrintToScreen ), printCounterScreen = printIntScreen;  end
      if( shouldPrintToFile ),   printCounterFile   = printIntFile;    end
   end
   [TimeOdeArray, VarOdeArray, timeEventOccurredInIntegrationStep, nStatesArraysAtEvent, nIndexOfEvents] = ode45( @mdlDerivatives, [t tAtEndOfIntegrationStep], VAR, OdeMatlabOptions, 0 );
   if( isempty(timeEventOccurredInIntegrationStep) ),
      lastIndex = length( TimeOdeArray );
      t = TimeOdeArray( lastIndex );
      VAR = VarOdeArray( lastIndex, : );
      printCounterScreen = printCounterScreen - 1;
      printCounterFile   = printCounterFile   - 1;
      if( abs(tAtEndOfIntegrationStep - t) >= abs(epsilonT) ), warning('numerical integration failed'); break;  end
      tAtEndOfIntegrationStep = t + tStep;
      if( (integrateForward && tAtEndOfIntegrationStep > tFinal) || (~integrateForward && tAtEndOfIntegrationStep < tFinal) ) tAtEndOfIntegrationStep = tFinal;  end
   else
      t = timeEventOccurredInIntegrationStep( 1 );    % time  at firstEvent = 1 during this integration step.
      VAR = nStatesArraysAtEvent( 1, : );             % state at firstEvent = 1 during this integration step.
      printCounterScreen = 0;
      printCounterFile   = 0;
      [isIntegrationFinished, VAR] = EventDetectedByIntegrator( t, VAR, nIndexOfEvents(1) );
   end
end
end


%==================================
end    % End of function MIPSI_SUP
%==================================
